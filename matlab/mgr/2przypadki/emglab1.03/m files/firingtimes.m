function e = firingtimes (unit, t0, t1)% Estimates the expected firing times for the bar display.% Copyright (c) 2006-2009. Kevin C. McGill and others.% Part of EMGlab version 1.0.% This work is licensed under the Aladdin free public license.% For copying permissions see license.txt.% email: emglab@emglab.net	e = [];	if unit==0; return; end;		fullpat = emgslist (unit);	if length(fullpat)<8; return; end;			tmid = (t0+t1) / 2;	nearpat = fullpat (fullpat > tmid-1 & fullpat < tmid+1);	if length(nearpat)>8;		[meanisi, stdisi] = firingstats (nearpat);	else		[meanisi, stdisi] = firingstats (fullpat);	end;	pat = fullpat (fullpat > t0-2*meanisi & fullpat < t1+2*meanisi);		lmm = pat - 1.3*meanisi;	lm  = pat - 1.1*meanisi;	l   = pat - 1.0*meanisi;	lp  = pat - 0.9*meanisi;	lpp = pat - 0.7*meanisi;		rmm = pat + 0.7*meanisi;	rm  = pat + 0.9*meanisi;	r   = pat + 1.0*meanisi;	rp  = pat + 1.1*meanisi;	rpp = pat + 1.3*meanisi;		ie = 0;	for i=1:length(pat);		[b,k] = min(abs(r - l(i)));		if lpp(i) > rmm(k) & lmm(i) < rpp(k);			ie = ie + 1;			e(ie,:) = [min(lm(i),rm(k)), max(lp(i),rp(k))];		else			ie = ie + 1;			e(ie,:) = [lm(i), lp(i)];		end;		[b,k] = min(abs(r(i) - l(:)));		if lpp(k) > rmm(i) & lmm(k) < rpp(i);		else			ie = ie + 1;			e(ie,:) = [rm(i), rp(i)];		end;	end;