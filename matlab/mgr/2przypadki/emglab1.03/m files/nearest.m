function y1 = nearest (x, y)% Find elements of x that are nearest to those in y.% Copyright (c) 2006-2009. Kevin C. McGill and others.% Part of EMGlab version 1.0.% This work is licensed under the Aladdin free public license.% For copying permissions see license.txt.% email: emglab@emglab.net	lx = length(x);	ly = length(y);	if lx==0 | ly==0; 		y1 = [];		return;	elseif ly==1 & lx==1;        y1 = x;        return;    elseif ly==1;		if y<x(1);			y1 = x(1);		elseif y>x(lx);			y1 = x(lx);		else			i = max(find(y>x));			y1 = x(i + (x(i+1)-y < y-x(i)) );		end;		return;	end;	x = x(:);	y = y(:);	y1 = zeros(length(y),1);	i1 = find(y<=x(1));	i2 = find(y>x(1) & y<x(length(x)));	i3 = find(y>=x(length(x)));	[b,i] = sort([x;y(i2)]);	ui(i) = 1:length(i);	u = ui(length(x)+1:length(ui)) - (1:length(i2));	if length(i1) > 0;		y1(i1) = x(1)*ones(length(i1),1);	end;	if length(i2) > 0;		y1(i2) = x(u + round((y(i2)-x(u))./(x(u+1)-x(u)))');	end;	if length(i3) > 0;		y1(i3) = x(length(x))*ones(length(i3),1);	end;	