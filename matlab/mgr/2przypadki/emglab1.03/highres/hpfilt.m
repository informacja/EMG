function x = hpfilt (x, cutoff_frequency);% first-order low-pass butterworth filter% applied in forward and reverse directions (like filtfilt)% Copyright (c) 2006-2009. Kevin C. McGill and others.% Part of EMGlab version 1.0.% This work is licensed under the Aladdin free public license.% For copying permissions see license.txt.% email: emglab@emglab.net	if cutoff_frequency > 0;		[x, t0, dt, type] = sigsep (x);		if cutoff_frequency >= 1/2/dt;			error ('Cutoff frequency must be less that half the sampling rate.');		end;		g = cos (2*pi*cutoff_frequency*dt);		b = roots([2*g, 2*(1-g), g-1]);		b = b(b>=0 & b<=1);		a = [1, 2*b-1];		b = [1-b, b-1];		x = filter (b, a, x(end:-1:1,:), x(end,:)*b(2));		x = filter (b, a, x(end:-1:1,:), 0);		x = mksig (x, t0, dt, type);	end;