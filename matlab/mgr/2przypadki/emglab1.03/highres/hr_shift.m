function p = hr_shift (p, d);% HR_SHIFT High resolution time-shift operator.%    P1 = HR_SHIFT (P, D) ->	shifts the continuous signal represented by%    P by D sampling intervals. Both P and P1 are vectors of RTP%    coefficients. D must be a real number, but does not have to be an integer.%    The time shift is circular, such that RTPSHIFT(P, M) = P if M is an%    integer multiple of length(P). %    If D is a scalar, then each column of P will be shifted by the same%    amount. Otherwise D must have as many entries as P has columns.%%    Note that HR_SHIFT is invertible only if length(P) is odd. In other words,%    if P1 = HR_PSHIFT (P, D); P2 = HR_SHIFT (P1, -D); then P2 will equal P%    if length(P) is odd, but it may only approximately equal P if%    length(P) is even.% %    See also RTP, IRTP% Copyright (c) 2006-2009. Kevin C. McGill and others.% Part of EMGlab version 1.0.% This work is licensed under the Aladdin free public license.% For copying permissions see license.txt.% email: emglab@emglab.net	if length(d)==1;		d = d*ones(1,size(p,2));	end;	[c, lx, l2] = rtp_to_dft (p);	om = [0:l2-1]' * d(:)' * 2 * pi / lx;	c = c.*exp(-j*om);	p = dft_to_rtp (c, lx);